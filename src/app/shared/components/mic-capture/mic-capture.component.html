<div class="mic-capture">
  <!-- Error display -->
  <div class="error-message" *ngIf="errorMessage">
    <span>âš ï¸ {{ errorMessage }}</span>
    <button (click)="clearError()" class="btn-close">âœ•</button>
  </div>

  <div class="controls">
    <button (click)="start()" [disabled]="running">Iniciar micrÃ³fono</button>
    <button (click)="stop()" [disabled]="!running">Detener</button>
    <button (click)="useDetected()" [disabled]="!last.frequency">Usar detecciÃ³n</button>
    <button (click)="toggleLock()" class="lock-btn">{{ locked ? 'ğŸ”’ Bloqueado' : 'ğŸ”“ Bloquear' }}</button>
  </div>

  <div class="status">
    <div class="row"><strong>Frecuencia:</strong> {{ last.frequency || '-' }} Hz</div>
    <div class="row"><strong>Frecuencia (suavizada):</strong> {{ smoothedFreqDisplay }}</div>
    <div class="row"><strong>Nota:</strong> {{ last.note || '-' }} <span *ngIf="last.cents">({{ last.cents }}Â¢)</span></div>
    <div class="row"><strong>Confianza:</strong>
      <span class="conf-label">{{ smoothedConfPercent }}%</span>
      <div class="conf-bar"><div class="conf-fill" [style.width.%]="smoothedConfPercent"></div></div>
    </div>
  </div>
</div>
